### [1.云端资源调度器的调度模型](#云端资源调度器的调度模型锚点)
- #### [中央式调度模型](#中央式调度模型锚点)
- #### [两层式调度模型](#两层式调度模型锚点)
- #### [基于共享状态的调度模型](#基于共享状态的调度模型锚点)
### [2.资源调度策略](#资源调度策略锚点)

---
为了了解Kubernetes的资源调度策略，首先我们对云平台中涉及到的两大问题作点简单的介绍，即使用什么样的调度模型和资源调度的策略是什么。

<span id="云端资源调度器的调度模型锚点"></span>
### 1.云端资源调度器的调度模型
<span id="中央式调度模型锚点"></span>
- #### 中央式调度模型

中央式资源调度模型表现为所有集群状态信息都存储在唯一的调度器实例
上，可扩展性较差。随着集群规模的增长，快速膨胀的集群信息将会使单节点的资源调度器实例变得＂不堪重负＂，从而严重影响系统的整体性。

Docker公司的容器编排工具--Swarm就是中央式调度模型的典型实现。Swarm的调度器模块Scheduler支持的调度算法有Random,Spread和Binpack。

- Swarm的Scheduler    
    - Random算法不考虑其他别的因素，只是随机地选择集群中的一个节点检查其资源容量是否满足待调度容器的需求。如果满足，则将容器调度到该工作节点上；否则检查集群中的其他节点直到有一个满足要求或所有节点均不满足返回错误。
    - Spread算法是尽量将容器分散调度到不同的节点上，以实现集群范围内所有节点的负载均衡。该算法的执行过程就是先遍历集群中所有工作节点目前运行的容器个数，然后检查运行容器个数最少的那个工作节点是否满足资源需求，如果满足则选择该工作节点；否则检查运行容器第二、第三个...第N少的工作节点直到结束。
    - Binpack算法与Spread算法刚好相反，是尽量将容器集中调度到数量尽可能
    少的节点上，以实现集群节点的压缩。该算法的执行过程与Spread算法非常类似，只是Spread算法是优先检查运行容器个数最少的那个工作节点，而Binpack算法则刚好相反，优先检查运行容器个数最多的那个工作节点。Binpack算法的副作用是过多容器相互＂挤占＂同一个工作节点的系统资源导致运行的不可靠性。

<span id="两层式调度模型锚点"></span>
- #### 两层式资度模型

在两层式资源调度模型中，具体的作业调度算法是由每一个独立的调度框架实现的，资源调度器只负责资源的分发。两级调度模型将资源调度和任务分配分离，使任务的调度逻辑能够依据不同类型应用要求而进行定制，并且增加了集群内资源共享的可能性。

Apache基金会的Mesos为两层式资源调度器的典型代表。Mesos是Apache下的开源分布式资源管理框架，可以很容易实现分布式应用的自动化调度。具体的信息可以看[Mesos简介](https://www.jianshu.com/p/cb211a1532be)。

Apache的Mesos使用DRF(Dominant Resources Fairness主导资源公平)算法实现资源的分配。DFS算法是一种考虑到不同用户对资源(包括：CPU和内存等)有不同需求而设计的一种公平分配算法。不同的task对不同类型的资源有需求，mesos会根据每一个task的需求占集群总资源的比率，为每一个task选取一个主导资源，并且计算这个主导资源在集群中所占用的比率，用这个比率给 task 进行优先级排序。每一次新的分配，都会优先选择把资源给当前所占比率最低的那个task。

<span id="基于共享状态的调度模型锚点"></span>
- #### 基于共享状态的调度模型

状态共享调度模型中的集群状态会被应用层次调度器独立更新，一旦本地有更新，
调度器会发布一个并发操作来更新所有共享集群状态。每个节点仅维护自己的状态，将更新发送给其它的代理如调度器、设备健康监控和资源控制系统。状态共享调度模型使用乐观锁进行共享状态的并发控制。

Google公司的Kubernetes为基于共享状态的资源调度模型的典型应用。

<span id="资源调度策略锚点"></span>
### 2.资源调度策略
- 静态调度：静态资源调度策略的前提是应用对资源的使用量基本保持不变，在资源申请的最初阶段就已完成资源的静态分配，并且在应用运行期间不再改变。
- 动态调度：动态调度策略则在应用运行期间周期性的统计资源使用情况，根据实际消耗的资源量，动态的调整应用的资源申请配额。动态调度的目的是按需将资源分配给应用，并且能充分利用系统资源，得到一个近似的资源配置最优解。
- 部分动态调度：态调度策略则综合了前两种策略，一部分资源配置的工作在系统的最初的阶段完成，另一部分资源配置工作在应用运行时根据资源负载情况动态的调整资源的分配，其目标是以消耗特定的计算资源为代价，来换取一个近似最优的资源配置方案。
